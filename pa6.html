<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>PA6: D3 Visual Animation</title>
    <script src="d3.min.js" charset="utf-8"></script>
    <style type="text/css">
      #control-buttons{
        width: 800px;
        height: 40px;
        text-align: center;
      }
    </style>

    <script>
    function startButton(){
      button = document.getElementById("start-reset");
      switch(button.innerHTML){
          case "Start":
          button.innerHTML = "Reset";
          animationMain();
          break;
        case "Reset":
          button.innerHTML = "Start";
          stopAnimation();
          break;
      }
    }

    function chime(){
      //A responsive event triger to send to the animation sequence
      //An idea: every odd chime the colors of all the LED's become a shade brighter; every even chime the speed of the animation quickens
    }

    function animationMain(){
      //Main deterministic animation driver
      zigLow(d3.selectAll("#led1"), "blue");
      zigHigh(d3.selectAll("#led2"), "blue")
    }

    function stopAnimation() {
      d3.selectAll(".led").transition().duration(0).attr("fill", "white");
    }

    /* Input: d3.selection */
    function zigLow(selection, color, state) {
      selection.attr("fill", "white")
        .transition()
        .delay(500)
        .attr("fill", color)
        .duration(1000)
        .each("end",  function() {zigHigh(selection, color, state)});
    }

    function zigHigh(selection, color, state) {
      selection.attr("fill", color)
        .transition()
        .delay(500)
        .attr("fill", "white")
        .duration(1000)
        .each("end", function() {zigLow(selection, color, state)});
    }

    function marqueeSequence(color, timeSteps){
      var LEDs = d3.selectAll(".led");
      var i = 0;                    
      function marqueeLoop() {         
         setTimeout(function () {    
            LEDs.each(function(d, j){
                var currentCircle = d3.select(this);
                console.log(this);
                if(i % 2 == 0){
                  if(j % 2 == 0){
                    currentCircle.attr("fill", color);
                  } else{
                    currentCircle.attr("fill", "white");
                  }
                } else {
                  if(j % 2 == 0){
                    currentCircle.attr("fill", "white");
                  } else {
                    currentCircle.attr("fill", color);
                  }
                }
            });           
            i++;                     
            if (i < timeSteps) {           
               marqueeLoop();             
            }                      
         }, 500)
      }
      marqueeLoop(); 
    }
  </script>
  </head>
  <body>
    <svg width="800" height="400" boarder="1">
      <rect id="stage" x="0" y="0" width="800" height="400" stroke="black" stroke-width="1" fill-opacity="0.0"/>
        <circle class="led" id="led1" cx="50" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led2" cx="150" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led3" cx="250" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led4" cx="350" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led5" cx="450" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led6" cx="550" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led7" cx="650" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led8" cx="750" cy="50" r="40" stroke="black" stroke-width="1" fill="white"/>

        <circle class="led" id="led9" cx="50" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led10"  cx="150" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led11"  cx="250" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led12"  cx="350" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led13"  cx="450" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led14"  cx="550" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led15"  cx="650" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led16"  cx="750" cy="150" r="40" stroke="black" stroke-width="1" fill="white"/>

        <circle class="led" id="led17"  cx="50" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led18"  cx="150" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led19"  cx="250" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led20"  cx="350" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led21"  cx="450" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led22"  cx="550" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led23"  cx="650" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led24"  cx="750" cy="250" r="40" stroke="black" stroke-width="1" fill="white"/>

        <circle class="led" id="led25"  cx="50" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led26"  cx="150" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led27"  cx="250" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led28"  cx="350" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led29"  cx="450" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led30"  cx="550" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led31"  cx="650" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
        <circle class="led" id="led32"  cx="750" cy="350" r="40" stroke="black" stroke-width="1" fill="white"/>
    </svg>
    </br>
    <div id="control-buttons">
      <button id="start-reset" type="button" onclick="startButton()">Start</button>
      <button id="chime" type="button" onclick="chime()">Chime</button>
    </div>
  </body>
</html>